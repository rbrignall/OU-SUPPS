% +--------------------------------------------------+
% | Typeset this file to document the OU-SUPPS       |
% +--------------------------------------------------+
%
% Copyright (c) 2015-2020 by Robert Brignall for The Open University.
% All Rights Reserved.
%
% This file is part of the OU-SUPPS distribution.
% ------------------------------------------------------------
% 
% It may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
% 

\documentclass[a4paper]{ltxguide}

\makeatletter
\newenvironment{desc}
  {\if@nobreak
     \vskip-\lastskip
     \vspace*{-2.5ex}%
   \fi
   \decl}
  {\enddecl}
\makeatother

\newcommand\3{\unskip\enspace\fbox{\fontsize{4}{4}\selectfont NEW 3.0}}
\newcommand{\metakeyavailable}{\textbullet}
\usepackage[T1]{fontenc}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{hyperref}

\pagestyle{headings}
\let\MakeUppercase=\relax

%\usepackage{pslatex}

\title{\textsf{OU-SUPPS}\\Class files for Open University teaching material}

\author{Robert Brignall\footnote{For bug reports, comments and
suggestions go to \href{https://github.com/rbrignall/OU-SUPPS}%
{\texttt{https://github.com/rbrignall/OU-SUPPS}}.}}

\date{Version 2.4\\2021-11-09}

\IfFileExists{enumitem.sty}{\usepackage{enumitem}}{}

\addtolength{\topmargin}{-3pc}
\addtolength{\textwidth}{6pc}
\addtolength{\oddsidemargin}{-2pc}
\addtolength{\textheight}{7pc}

\raggedright

\parindent 0pt
\parskip 4pt
\begin{document}

\maketitle

\tableofcontents

\section{Introduction}

The \textsf{OU-SUPPS} repository contains four class files:
\begin{itemize}
\item \texttt{ouab.cls} for Assignment Booklets and TMA booklets;
\item \texttt{outn.cls} for Tutor Notes and specimen solutions (for distribution to students);
\item \texttt{ouexam.cls} for exams, specimen exams, and solutions;
\item \texttt{ouicma.cls} for print versions of iCMAs (e.g. for offender learners).
\end{itemize}

In addition, template \LaTeX\ files for each class file are available, illustrating most of the features available.

\section{Installation and basic usage}

\textsf{OU-SUPPS} does not need installation. To use:

\begin{enumerate}
\item Download the contents of the \textsf{OU-SUPPS} repository from \href{https://github.com/rbrignall/OU-SUPPS}%
{\texttt{https://github.com/rbrignall/OU-SUPPS}}.
\item Save the contents in your working folder.
\item Open the template tex file for the class you want to use with your \LaTeX\ editor, and compile it \emph{twice} (using either \texttt{latex} or \texttt{pdflatex}). 
\item Your \LaTeX\ distribution may ask to install a few packages the first time you compile each of the template files.
\item If it compiled successfully, then everything is working as expected.
\end{enumerate}

\paragraph{Important:} When writing a SUPP file using the new system, as a minimum you will need to have the following files in your working folder:
\begin{itemize}
\item The tex source for your document.
\item The relevant class file (e.g.\ \texttt{ouab.cls} if you're creating an Assignment Booklet).
\end{itemize}

\paragraph{Logo files:}The OU Logo files are no longer held in the Github repository, and are \emph{not} required to be able to compile tex files that use any of the classes in \textsf{OU-SUPPS}. If you are a central member of staff and require a copy of the OU logos, please speak to the developer (Robert Brignall) or the DPU.


\section{Using \texttt{ouab.cls}}

This section covers the features available in |ouab.cls|, for writing Assignment Booklets and TMA books. |ouab.cls| is based on the standard |article| class file, so any commands used there can be used in |ouab|.

\subsection{Preamble}

\subsubsection{Options}
As well as the default version, there are two options available. These options do not affect the syntax you use for the rest of your file.

\begin{desc}
|\documentclass{ouab}|
\end{desc}

This is the default operation for using |ouab.cls|. It produces a table of contents on the front page, and is designed for Assignment Booklets containing more than one TMA/CMA.

\begin{desc}
|\documentclass[oneassignment]{ouab}|
\end{desc}

This version is designed for booklets that contain (e.g.) a single TMA (although it will let you have more than one assignment in the source). Instead of a table of contents on the front page, it inserts information provided by the first assignment in the |latex| file.

\begin{desc}
|\documentclass[draft]{ouab}|
\end{desc}

Draft mode. In this mode, the system will check that the stated total marks for a question (i.e.\ the number $n$ in |\question[...]{|$n$|}[...]|) is equal to the number of marks produced by |\mk{...}|. If the numbers do not add up, it reports this issue in the PDF at the bottom of the question.

\emph{Note:} Questions that are created with |\question*| that have no mark specified will not be checked by this system, nor will a question with a specified total of 0 marks.

\begin{desc}
|\documentclass[oneassignment,draft]{ouab}|
\end{desc}

As always, you can combine options and the effects of each option will be seen.



\subsubsection{Commands to be used in the preamble}
\begin{desc}
|\faculty{...}|
\end{desc}
The name of the faculty (optional, default is `Faculty of Science, Technology, Engineering and Mathematics')
\begin{desc}
|\modulecode{...}|
\end{desc}
Sets the code of the module (required).
\begin{desc}
|\moduletitle{...}|
\end{desc}
Sets the title (i.e./ name) of the module (required).

\begin{desc}
|\abtitle{...}|
\end{desc}
Sets the title for the Assignment Booklet (required).

\begin{desc}
|\absubtitle{...}|
\end{desc}
Subtitle for the Assignment Booklet (optional, default is blank).

\begin{desc}
|\abyear{...}|
\end{desc}
Sets the year/presentation for this AB (required).

\begin{desc}
|\copyrightyear{...}|
\end{desc}
Sets the date for copyright, used in the footer on the front page (optional, default is same as |\abyear|).


\begin{desc}
|\suppno{...}| %can be omitted for "DRAFT"
\end{desc}
Sets the SUPP number, mainly used by DPU/LTS (optional, default is `DRAFT').

\begin{desc}
|\versionno{...}| %optional
\end{desc}
Sets the version number, mainly used by DPU/LTS (optional, default is blank).

\begin{desc}
|\optiontext{...}|
\end{desc}
Changes the text that appears at the top of multi-choice questions (optional, default is `Options:'). Does not need to be in the preamble, so you can change the text for options part-way through the document.

\begin{desc}
|\nocutoffdate|
\end{desc}
This switches off the text ``Cut-off date'' that appears (e.g.) on the front page (optional). Use this for modules where the cut-off dates are not provided in the assignment booklet.


\begin{desc}
|\abinstructions{...}|
\end{desc}
Command for the instructions/rubric on the front page of the booklet (optional, but defaults to `No special instructions specified.')

\begin{desc}
|\oulogofilebase{...}|
\end{desc}
Overrides the internally-specified for the name of the OU logo, currently |OU_Master_Logo_Black_CMYK_29mm|. The filename should be specified \emph{without} extension (|.pdf| or |.eps|), as this will be added automatically depending on whether the source file is compiled using |latex| or |pdflatex|.

\LaTeX\ files that use \textsf{OU-SUPPS} class files do \emph{not} need the OU logo to compile: if the specified logo file is not present, a placeholder box will be inserted instead.


\begin{desc}
|\metadataset{key=value}|  
\end{desc}
As an alternative to specifying the above commands individually, they can 
all be configured using a |key=value| approach in the |\metadataset|
command; for example:
\begin{verbatim}
\metadataset{faculty=Science Technology Engineering and Mathematics, 
            module code=MST125,
            module title=Title of Module,
            document title=AB title,
            document subtitle=AB subtitle,
            presentation=2017B,
            copyright year=1999,
            supp no=3.14159,
            version no=1.12,
            multiple choice option text=choices,
            no cut off date,
            instructions=some specific instructions,
            }
\end{verbatim}
\subsection{Creating assignments}
Three commands are available to create assignments: TMA, CMA, and a generic command for creating any other type.

\begin{desc}
|\tma[<date>]{<number>}[<subtitle>]|\\
|\tma*[<date>]{<number>}[<subtitle>]|
\end{desc}
Creates a TMA with number equal to |<number>|. The |<date>| and |<subtitle>| parts are both optional and can be omitted. The starred version suppresses the |\newpage| command, so does not insert a new page before the assignment.

|<date>| specifies the cut-off date for the TMA.

|<subtitle>| specifies text for the `subtitle', which is only used in the description of the assignment on the front page.

\begin{desc}
|\cma[<date>]{<number>}[<subtitle>]|\\
|\cma*[<date>]{<number>}[<subtitle>]|
\end{desc}
Creates a CMA, usage as per |\tma|. The starred version suppresses the |\newpage| command, so does not insert a new page before the assignment.

\begin{desc}
|\assignment{<name>}[<date>]{<number>}[<subtitle>]|\\
|\samepageassignment{<name>}[<date>]{<number>}[<subtitle>]|
\end{desc}

Creates an assignment type |<name>| (required), numbered with |<number>|. The |<date>| and |<subtitle>| parts are both optional and can be omitted. The |\samepageassignment| variant creates an assignment without inserting a new page, whereas |\assignment| inserts a new page.

All assignment types add an entry  to the table of contents on the front page, and reset the |question| counter to 0. The behaviour of the table of contents depends on whether the |oneassignment| option has been specified or not.

\subsection{Creating questions}
The internal counter used for generating questions is |question|.  This gets reset at the start of each assignment.


\subsubsection{Question syntax}

\begin{desc}
|\question[<description>]{<marks>}|
\end{desc}
Creates a new question, with the number of marks available specified by the command |<marks>|.

The parameter |<description>| is optional, and can be used to provide additional information about the question in its header line. 


\begin{desc}
|\question*[<description>]|
\end{desc}
Starred variant of |\question| which does not require the number of marks to be specified. The parameter |<description>| is optional.


\subsubsection{Subquestions}
To create subquestions, use the standard \LaTeX\ |enumerate| environment.

\begin{verbatim}
\begin{enumerate}
\item ...
\item ...
...
\end{enumerate}
\end{verbatim}

These environments can be nested to create subsubquestions, etc. The default numbering style is |(a),(b),...| for subquestions, and |(i),(ii),...| for subsubquestions.

For inline subquestions, use the starred version of the |enumerate| environment:

\begin{verbatim}
\begin{enumerate*}
\item ...
\item ...
...
\end{enumerate*}
\end{verbatim}

Numbering style for |enumerate*| is |(i),(ii),...| at all levels. This can be adjusted using |enumitem| (see below).

The class file |ouab.cls| loads the |enumitem| package, which provides a number of features, two of which we list here.

\begin{itemize}
\item Changing the numbering: Start the environment using, e.g.\ |\begin{enumerate}[A.]|, to modify the numbering system to |A.,B.,...|.
\item Resuming numbering after a break: use |\begin{enumerate}[resume]| to continue counting from the previous time an enumerate environment at this level was called.
\end{itemize} 

For fuller details of the possibilities with |enumitem|, see the documentation on its CTAN entry.

\subsubsection{Marks}
Marks can be placed anywhere in the document (including inside displayed equations). You may need to  compile your |tex| file twice in order for the marks to be correctly aligned.

\begin{desc}
|\mk{<n>}|
\end{desc}
Places |<n>| in square brackets in the right hand margin on the line. 

If using the |draft| option, when compiled, \LaTeX\ will check whether the sum of the entries inside |\mk| commands adds up to the parameter |<marks>| specified by the preceding |\question|. This has some limitations (e.g.\ it won't understand |\tfrac{1}{2}|). If the numbers are not the same, a box will be output reporting the discrepancy. 


%\begin{desc}
%|\marks{<n>}|
%\end{desc}
%A synonym for |\mk|. This command has been deprecated and will be removed in a later release.

\subsubsection{Multiple choice} 

For CMAs and other assignment types that have multiple choice questions, the following commands are available.

The text appearing at the top of each list of options can be changed using the |\optiontext{<title>}| command. This command can be used in the premable, or at any point in the document.

\begin{desc}
|\begin{options}|\\
|   \item ...|\\
|   \item ...|\\
|\end{options}|
\end{desc}
Creates a list of options, with the text of each |\item| starting on a new line. Options are labelled |A.,B.,C.,...|.

\begin{desc}
|\begin{inlineoptions}[<line spacing>]{<columns>}|\\
|   \item ...|\\
|   \item ...|\\
|\end{inlineoptions}|
\end{desc}
Creates a list of options, displayed in |<columns>| number of columns, equally spaced. Each successive |\item| is placed sequentially from left to right, then starting a new line as necessary. Options are labelled |A.,B.,C.,...|.

The optional parameter |<line spacing>| can be used to increase the spacing between each line. However, note that this also affect spacing within options, which can have undesired effect if your options include, e.g., a |matrix| environment.

\begin{desc}
|\noitem|
\end{desc}
This command can be used within  |inlineoptions| to leave a `blank' in the list of options. This is particularly useful on the final line if you have fewer |\item|s left than the specified number of |<columns>|.


\subsection{Technical info}
This section can be omitted unless you need/want to know a bit more about the class file.

\subsubsection{Packages loaded}
|ouab.cls| loads the following packages automatically, so you do not need to call |\usepackage{...}| to use the features provided by these.

\begin{itemize}
\item |geometry| to set page margins, sizes, etc
\item |fancyhdr| for formatting headings
\item |graphicx| for handling images, etc
\item |changepage| to adjust page widths automatically
\item |array| extends the |array| and |tabular| environments.
\item |amsmath| loaded with the |fleqn| option to left-align displayed mathematics.
\item |amssymb| extra mathematical symbols
\item |zref-user|, |zref-lastpage| for knowing how many pages the document contains
\item |ifthen| for internal latex coding
\item |enumitem| with options |inline| and |shortlabels|. This is a powerful tool that will help preparing subquestions (see later).
\item |marginnote| for handling marks, etc in the margin.
\item |caption| with option |labelsep=quad| to improve formatting for figures.
\item |pgfkeys| for setting flexible options in commands.
\end{itemize}

%
%
%
%
%
%
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Using \texttt{outn.cls}}


This section covers the features available in |outn.cls|, for writing Tutor Notes and Specimen Solutions for assignments. |outn.cls| is based on the standard |article| class file, so any commands used there can be used in |outn|. Note also that the syntax is as close as possible to that created in |ouab.cls|, so, in theory, the two types of SUPP could be generated from a common source at a reasonably advanced stage of development. 

\subsection{Preamble}

\subsubsection{Options}
As well as the default version to produce tutor notes, there are two options available. These options do not affect the syntax you use for the rest of your file.

\begin{desc}
|\documentclass{outn}|
\end{desc}

This is the default operation for using |outn.cls|. It produces a Tutor Notes booklet.

\begin{desc}
|\documentclass[specsolns]{outn}|
\end{desc}

This version is designed to create a specimen solutions PDF. In this mode, a number of commands have no effect, e.g. those for specifying marks (|\mk| and |\subtotal|, etc), the title is changed to reflect the different type of document, and (by default) the font colour is changed to green.


\subsubsection{Commands to be used in the preamble}\label{outn-preamble}
\begin{desc}
|\faculty{...}|
\end{desc}
The name of the faculty (optional, default is `Faculty of Science, Technology, Engineering and Mathematics')
\begin{desc}
|\modulecode{...}|
\end{desc}
Sets the code of the module (required).
\begin{desc}
|\moduletitle{...}|
\end{desc}
Sets the title (i.e./ name) of the module (required).

\begin{desc}
|\tntitle{...}|
\end{desc}
Sets the title for the Tutor Notes/Specimen Solutions (required).

\begin{desc}
|\tnyear{...}|
\end{desc}
Sets the year/presentation for this TN (required).

\begin{desc}
|\copyrightyear{...}|
\end{desc}
Sets the date for copyright, used in the footer on the front page (optional, default is same as |\tnyear|).


\begin{desc}
|\specsolnscolor{<color>}|
\end{desc}
Command to change the font color used in Specimen Solutions to |<color>| (e.g. |blue| or |red|). The class file loads the package |xcolor.sty| so you can use this to specify your own colors. This command is optional, the default color is |ougreen|, which is defined in |outn.cls| by |\definecolor{ougreen}{RGB}{0,128,0}|.


\begin{desc}
|\optiontext{...}|
\end{desc}
Changes the text that appears at the top of multi-choice questions (optional, default is `Options:'). Does not need to be in the preamble, so you can change the text for options part-way through the document.

\begin{desc}
|\oulogofilebase{...}|
\end{desc}
Overrides the internally-specified for the name of the OU logo, currently |OU_Master_Logo_Black_CMYK_29mm|. The filename should be specified \emph{without} extension (|.pdf| or |.eps|), as this will be added automatically depending on whether the source file is compiled using |latex| or |pdflatex|.

\LaTeX\ files that use \textsf{OU-SUPPS} class files do \emph{not} need the OU logo to compile: if the specified logo file is not present, a placeholder box will be inserted instead.

\begin{desc}
|\switchmarks|
\end{desc}
This command (which can be used anywhere, but best used in the preamble) defines the various commands for entering marks so that any comments appear to the left of the mark.

\begin{desc}
|\metadataset{key=value}|  
\end{desc}
As an alternative to specifying the above commands individually, they can 
all be configured using a |key=value| approach in the |\metadataset|
command; for example:
\begin{verbatim}
\metadataset{faculty=STEM, 
            module code=MU123,
            module title=Title of Module,
            document title=Title of Tutor notes,
            presentation=2017B,
            copyright year=1999,
            specimen solutions color=blue!50!black,
            multiple choice option text=choices,
            tutor only title={{\bfseries Title for tutor-only environment\par}},
            student only title=Student material only\par,
            switch marks=true,
            }
\end{verbatim}

\subsection{Creating assignments}
Three commands are available to create assignments: TMA, CMA, and a generic command for creating any other type. These commands have the same syntax as in |ouab|, but the behaviour is slightly different (since |outn| does not produce a table of contents).

\begin{desc}
|\tma[<date>]{<number>}[<subtitle>]|\\
|\tma*[<date>]{<number>}[<subtitle>]|
\end{desc}
Creates a TMA with number equal to |<number>|. The |<date>| and |<subtitle>| parts are both optional and can be omitted. The starred version suppresses the |\newpage| command, so does not insert a new page before the assignment.

|<date>| specifies the cut-off date for the TMA.

|<subtitle>| has no effect in |outn|. It is parsed by the system and then ignored, so that the syntax is identical to that used by |ouab|.

\begin{desc}
|\cma[<date>]{<number>}[<subtitle>]|\\
|\cma*[<date>]{<number>}[<subtitle>]|
\end{desc}
Creates a CMA, usage as per |\tma|. The starred version suppresses the |\newpage| command, so does not insert a new page before the assignment.

\begin{desc}
|\assignment{<name>}[<date>]{<number>}[<subtitle>]|\\
|\samepageassignment{<name>}[<date>]{<number>}[<subtitle>]|
\end{desc}

Creates an assignment type |<name>| (required), numbered with |<number>|. The |<date>| and |<subtitle>| parts are both optional and can be omitted (and |<subtitle>| has no effect in |outn|). The |\samepageassignment| variant creates an assignment without inserting a new page, whereas |\assignment| inserts a new page.

All assignment types reset the |question| counter to 0. 
\subsection{Creating questions/solutions}
The internal counter used for generating questions/solutions is |question|.  This gets reset at the start of each assignment.


\subsubsection{Question syntax}

\begin{desc}
|\question[<description>]{<marks>}|
\end{desc}
Creates a new question (or solution), with the number of marks available specified by the command |<marks>|. The wording at the top of the question is `Solution to Question |<n>|'.

The parameter |<description>| is optional, and can be used to provide additional information about the question in its header line. 


\begin{desc}
|\question*[<description>]|
\end{desc}
Starred variant of |\question| which does not require the number of marks to be specified. The parameter |<description>| is optional.

\begin{desc}
|\begin{solution}...\end{solution}|
\end{desc}

An environment to contain the solution to a question. The contents of these environments are precisely what is output to the |latex| source file when using the experimental |studenttex| mode. If not using |studenttex| mode, this environment is merely a semantic feature, and does not need to be used. 

\subsubsection{Subquestions}
To create subquestions, use the standard \LaTeX\ |enumerate| environment.

\begin{verbatim}
\begin{enumerate}
\item ...
\item ...
...
\end{enumerate}
\end{verbatim}

These environments can be nested to create subsubquestions, etc. The default numbering style is |(a),(b),...| for subquestions, and |(i),(ii),...| for subsubquestions.

For inline subquestions, use the starred version of the |enumerate| environment:

\begin{verbatim}
\begin{enumerate*}
\item ...
\item ...
...
\end{enumerate*}
\end{verbatim}

Numbering style for |enumerate*| is |(i),(ii),...| at all levels. This can be adjusted using |enumitem| (see below).

The class file |outn.cls| loads the |enumitem| package, which provides a number of features, two of which we list here.

\begin{itemize}
\item Changing the numbering: Start the environment using, e.g.\ |\begin{enumerate}[A.]|, to modify the numbering system to |A.,B.,...|.
\item Resuming numbering after a break: use |\begin{enumerate}[resume]| to continue counting from the previous time an enumerate environment at this level was called.
\end{itemize} 

For fuller details of the possibilities with |enumitem|, see the documentation on its CTAN entry.

\subsubsection{Marks}
Marks can be placed anywhere in the document (including inside displayed equations). You may need to  compile your |tex| file twice in order for the marks to be correctly aligned. In |specsolns| mode, all the commands in this subsubsection are suppressed in the resulting PDF. In |studenttex| mode, all these commands are suppressed in the outputted |latex| source file.

\begin{desc}
|\mk[<description>]{<n>}[<voffset>]|\\
|\mk*[<description>]{<n>}[<voffset>]|
\end{desc}
Places |<n>| in the right hand margin on the line. The |<description>| (which could be a short sentence running to several lines) is placed to the right of the mark, but can be omitted (e.g. |\mk{5}|). 

If the |\switchmark| command is issued (see Subsubsection~\ref{outn-preamble}) then the mark |<n>| is placed to the \emph{right} of any |<description>|.

The optional final parameter |[<voffset>]| allows you to move the entire margin note up or down the page. |<voffset>| should be a measure (so needs units, such as |pt|, |cm|, |em| etc). This parameter can be useful when you have multiple margin notes that would otherwise overlap with one another. For example: |\mk[Long discussion]{2}[24pt]|.

The starred variant |\mk*| performs the same function, but does not add the value of |<n>| to the |total| and |subtotal| counters, so can be used, e.g., if several solutions are possible with separate mark schemes.

\emph{Note:} |<n>| can be non-numeric, but if anything other than an integer is entered, then the |\subtotal*| and |\total*| commands will return the wrong sum.

\begin{desc}
|\solnmarksplus{<n>}{<description>}|\\
|\mkplus{<n>}{<description>}|
\end{desc}
Some equivalent commands that produce the same effect as |\mk[<description>]{<n>}|. These commands are deprecated, and exist primarily for backward-compatibility. They will be removed in a later release.

\begin{desc}
|\subtotal[<description>]{<n>}[<voffset>]|\\
|\total[<description>]{<n>}[<voffset>]|
\end{desc}

Specifies that the subtotal or total for a part-question or question is |<n>|, placing |<n>| in the margin, and the word `Subtotal' or `Total' in large, bold to its right. The optional argument |<description>| can be used to append wording to the word `Total'. Typical usages of the |<description>| parameter are:\\ 
|\subtotal[for part \theenumi]{<n>]}|\\
|\total[for Question \thequestion]{<n>]}|.

See under the description of |\mk| above for information on usage of the optional parameter |[<voffset>]|.

\begin{desc}
|\subtotal*[<description>]|\\
|\total*[<description>]|
\end{desc}

Calculates the subtotal or total for a part-question or question, placing 
the calculated value in the margin, and the word `Subtotal' or `Total' in large, 
bold to its right; the calculated value accounts for all marks given in 
any of the following commands: |bracketedmarks|, |solnmarks|, |solnmarksplus|, 
|marks|, |mk|, and |mkplus|. The optional argument |<description>| is the same 
as with the |\subtotal| and |\total| commands. 

\emph{Note:} Marks entered into the |\mk*| variant will not be added to the |subtotal| and |total| counters.

\begin{desc}
|\setSubtotalHline[<options>]|
\end{desc}

Sets options (including turning off) for horizontal lines after |\subtotal| and
|\subtotal*| command. Supported options, in any order, are:
\begin{itemize}
  \item |moveleft=<length>|, default is |.1\textwidth|: specifies the horizontal offset of the line;
  \item |width=<length>|, default is |1.5\textwidth|: specifies the horizontal width of the line;
  \item |height=<length>|, default is |2pt|: specifies the height of the line;
  \item |color=<color>|, default is |black|: specifies the colour of the line;
  \item |draw line=<true/false>|, default is |true|: specifies if the line is to be drawn or not.
\end{itemize}

Simply calling |\setSubtotalHline| without options, resets all of the options
to their default values.

Sample uses include, for example:

|\setSubtotalHline[moveleft=0pt]|

|\setSubtotalHline[moveleft=0pt,height=5pt,color=orange]|

This command is just a short cut to the |\pgfkeys| command, and 
users familiar with the syntax of |\pgfkeys| might prefer to use, 
for example:

|\pgfkeys{/subtotalhline,default,moveleft=-3cm,color=red!40!white}|

\begin{desc}
|\setTotalHline[<options>]|
\end{desc}
This is analogous to the |\setSubtotalHline| command, and customises the lines
drawn (if any) after the |\total| and |\total*| commands. It takes exactly 
the same options as |\setSubtotalHline|, and each option performs the analogous
task; the default |height| for the |subtotal| horizontal lines is |1pt|, 
but all other defaults are the same as those for the  |total| horizontal lines.

Users who prefer to use |\pgfkeys| directly may use, for example,

|\pgfkeys{/totalhline,default,moveleft=-3cm,color=red!40!white}|

\begin{desc}
|\ourule[<options>]|
\end{desc}
This command enables users to draw a horizontal rule manually at some point in their tutor notes, 
not using any of the |\subtotal| and friends commands. It takes exactly the 
same options as |\setSubtotalHline|, and each option performs the analogous
task. The default 
values are copied from the default values of the |\setTotalHline|.

\begin{desc}
|\setOUrule[<options>]|
\end{desc}
Users may specify global options for their |\ourule| command in exactly the same 
way as in |\setSubtotalHline| and |\setTotalHline|.

Users who prefer to use |\pgfkeys| directly may use, for example,

|\pgfkeys{/ourule,default,moveleft=-3cm,color=red!40!white}|
\subsubsection{Multiple choice} 

For CMAs and other assignment types that have multiple choice questions, the following commands are available. It is unlikely that these will be needed in tutornotes, but they have been included for consistency with |ouab.cls|.

The text appearing at the top of each list of options can be changed using the |\optiontext{<title>}| command. This command can be used in the premable, or at any point in the document.

\begin{desc}
|\begin{options}|\\
|   \item ...|\\
|   \item ...|\\
|\end{options}|
\end{desc}
Creates a list of options, with the text of each |\item| starting on a new line. Options are labelled |A.,B.,C.,...|.

\begin{desc}
|\begin{inlineoptions}[<line spacing>]{<columns>}|\\
|   \item ...|\\
|   \item ...|\\
|\end{inlineoptions}|
\end{desc}
Creates a list of options, displayed in |<columns>| number of columns, equally spaced. Each successive |\item| is placed sequentially from left to right, then starting a new line as necessary. Options are labelled |A.,B.,C.,...|.

The optional parameter |<line spacing>| can be used to increase the spacing between each line. However, note that this also affect spacing within options, which can have undesired effect if your options include, e.g., a |matrix| environment.

\begin{desc}
|\noitem|
\end{desc}
This command can be used within  |inlineoptions| to leave a `blank' in the list of options. This is particularly useful on the final line if you have fewer |\item|s left than the specified number of |<columns>|.

\subsection{Comments for tutors or students}

Since the same |latex| source is expected to produce both tutor notes and (using |specsolns| mode) specimen solutions, commands are provided for comments to appear to tutors and/or students.

\emph{Warning: These commands are still under development and syntax/appearance is still liable to change in future.}

\begin{desc}
|\textref{<description>}|
\end{desc}

Inserts |<description>| in bold and italics, in a right-aligned box. Primarily expected to be used for references to texts or handbooks.


\begin{desc}
|\remark{<text>}|
|\begin{longremark}<text>\end{longremark}|
\end{desc}

Provides a command and environment in which to write text that is visible only in the tutornotes (i.e.\ it is suppressed in |specsolns| mode). The |longremark| environment is designed for longer paragraphs of explanation.

\emph{Warning: Do not use the |longremark| environment inside the |solutions| environment! In certain modes this will cause errors relating to verbatim mode.}

\begin{desc}
|\begin{references}<text>\end{references}|  
\end{desc}

Provides an environment for references; it typesets the word `References' in italics on its own line, with the |<text>| in normal font.

\begin{desc}
|\tutoronly{<commands/text>}|
\end{desc}
Commands, text, and anything else (e.g |\pagebreak|) passed to the |\tutoronly| command will only
output to tutor notes when the |specsolns| option is \emph{not} active.

\begin{desc}
|\begin{tutor}|
| <content>|
|\end{tutor}|
\end{desc}
Any content within the |\tutor| environment will only
output to tutor notes when the |specsolns| option is \emph{not} active.\label{outn:tutoronly}

\begin{desc}
|\tutoronlytitle{<title for tutor only environment>}|
\end{desc}
Sets the title for the |tutor| environment; the title, by default, will output
|{\bfseries For tutors only:}\par| but this can be changed using |\tutoronlytitle|. 

\begin{desc}
|\studentonly{<commands/text>}|
\end{desc}
Commands, text, and anything else passed to the |\studentonly| command will only
output to student notes when the |specsolns| option \emph{is} active.\label{outn:studentonly}

\begin{desc}
|\begin{student}|
|<content>|
|\end{student}|
\end{desc}
Any content within the |\student| environment will only
output to student notes when the |specsolns| option \emph{is} active.

\begin{desc}
|\studentonlytitle{<title for student only environment>}|
\end{desc}
Sets the title for the |student| environment; the title, by default, will output
|{\bfseries For students only:}\par| but this can be changed using |\studentonlytitle|. 

\begin{desc}
|\tutororstudent{<to the tutor>}{<to the student>}|  
\end{desc}
The |\tutororstudent| command takes two arguments; the first argument will only
be output when the |specsolns| is \emph{not} active, and the second argument 
will only be output when the |specsolns| \emph{is} active.

\begin{desc}
|\tutoronlycolor{<color>}|\\
|\studentonlycolor{<color>}|
\end{desc}
These commands set the color of the text in tutor- and student-specific comments and environments. The default is |black| for |\tutoronlycolor|, and the same as |\specsolnscolor| for |\studentonlycolor| (by default, this is |ougreen|).

\subsection{Technical info}
This section can be omitted unless you need/want to know a bit more about the class file.

\subsubsection{Packages loaded}
|outn.cls| loads the following packages automatically, so you do not need to call |\usepackage{...}| to use the features provided by these.

\begin{itemize}
\item |geometry| to set page margins, sizes, etc
\item |fancyhdr| for formatting headings
\item |graphicx| for handling images, etc
\item |changepage| to adjust page widths automatically
\item |array| extends the |array| and |tabular| environments.
\item |amsmath| loaded with the |fleqn| option to left-align displayed mathematics.
\item |amssymb| extra mathematical symbols
\item |zref-user|, |zref-lastpage| for knowing how many pages the document contains
\item |ifthen| for internal latex coding
\item |enumitem| with options |inline| and |shortlabels|. This is a powerful tool that will help preparing subquestions.
\item |marginnote| for handling marks, etc in the margin.
\item |caption| with option |labelsep=quad| to improve formatting for figures.
\item |xcolor| for colour
\item |framed| for framing environment
\item |pgfkeys| for setting flexible options in commands.
\item |environ|
\item |verbatim|
\end{itemize}



%
%
%
%
%
%
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Using \texttt{ouexam.cls}}

This section covers the features available in |ouexam.cls|, for writing exam papers, specimen (and second specimen) papers, and solutions to exams. 

In theory, the same |latex| source file can be used to generate both an exam script and its model solutions, which might be helpful for drafting purposes. For the final version to be handed over, it is advised that you create two source files (one for the exam, one for its solutions).

\subsection{Preamble}

\subsubsection{Options}
As well as the default version, there are three options available. These options do not affect the syntax you use for the rest of your file, except for some of the commands in the preamble (detailed later).

\begin{desc}
|\documentclass{ouexam}|
\end{desc}

This is the default operation for using |ouexam.cls| for setting exam papers. Any text in |solution| environments is ignored.

\begin{desc}
|\documentclass[specimen]{ouexam}|
\end{desc}

This version is designed for specimen exam papers. The formatting on the front page is changed, and certain commands (e.g.\ |\examtime|) are not required. See Subsection~\ref{subsec-specs} for full details on creating specimen papers.

\begin{desc}
|\documentclass[secondspecimen]{ouexam}|
\end{desc}

Version for second specimen exam papers. Formatting on the front page and requirements are similar to the |specimen| option.


\begin{desc}
|\documentclass[showsolutions]{ouexam}|
\end{desc}

This version creates a solution booklet. Formatting on the front page is changed, and the contents of |solution| environments gets displayed.

\begin{desc}
|\documentclass[specimensolutions]{ouexam}|\\
|\documentclass[specimen,showsolutions]{ouexam}|
\end{desc}

The |showsolutions| option can be used alongside the |specimen| option to provide model solutions for specimen exams formatted in a style expected by LTS. The major changes in this mode are the formatting of teh title, footer information, and text within the |solutions| environment will be displayed without additional formatting. The |specimensolutions| option is an alias for |specimen,showsolutions|.

\begin{desc}
|\documentclass[14pt]{ouexam}|
\end{desc}

This provides a large-print version for visually impaired students. Also available are |17pt| and |20pt|, and these all work with other options. These options should only be used in response to specific requests made by students, and should not be used to produce the standard exam.

\begin{desc}
|\documentclass[20pt,smallmargins]{ouexam}|
\end{desc}

The |smallmargins| option decreases the size of the left margin on all pages after the title page. This is typically only to be used in conjunction with the |20pt| option, where line length needs to be increased due to the large font size.

\begin{desc}
|\documentclass[nobarcode]{ouexam}|
\end{desc}

This option is available for drafting exams, suppressing the barcode production code (and the |makebarcode| package). In most cases, the DPU can insert the requisite barcode later.

[This was originally created when the system used the old OU\TeX\ code for barcodes, which relied on a specific font that was not always installed correctly in certain \TeX\ distributions. The new approach provided by the |makebarcode| package instead uses the |\rule| command to draw black and white lines of appropriate sizes.]

\begin{desc}
|\documentclass[remote]{ouexam}|
\end{desc}

This option changes the formatting of the exam to make it more suitable for remote `print at home' examinations. The main changes are that it:
\begin{itemize}
	\item Removes the time of the exam, and the `Time allowed:' line on the front page.
	\item Adds a |\submitby| command to insert an upload deadline (see next subsubsection)
	\item Modifies the footer on pages 2 onwards, to make it clearer to students at-a-glance whether they have printed all pages correctly.
\end{itemize}


\subsubsection{Commands to be used in the preamble}\label{ouexam-preamble}
\begin{desc}
|\modulecode{...}|
\end{desc}
Sets the code of the module (required).

\begin{desc}
|\session{...}|
\end{desc}
Sets the session code for the exam (required, except for |specimen| and |secondspecimen|). This replaces the deprecated |\conflation{...}| command (although this still works to ensure backwards compatibility).

If |specimen| or |secondspecimen| options are used, |\session{...}| can be used to overwrite the text `Specimen' or `Second Specimen' as appears in the title and footer. For example, you could specify |\session{Third specimen}|.

\begin{desc}
|\moduletitle{...}|
\end{desc}
Sets the title (i.e.\ name) of the module (required).

\begin{desc}
|\specimensolutionstitle{...}|
\end{desc}
Optional. Sets the title that appears at the top of the specimen solutions in |specimensolutions| mode. Default is ``Solutions to the second examination paper''. It has no function in other modes.

\begin{desc}
|\examcode{<code>}|
\end{desc}
Encodes |<code>| for the barcode on the front page (optional, default is blank).

\begin{desc}
|\examtime{<start> -- <finish>}|\\
|\examday{<day>}|\\
|\exammonth{<month>}|\\
|\examyear{<year>}|
\end{desc}

Specifies the time, day, month and year of the exam (required, except for |specimen| and |secondspecimen|).

\begin{desc}
|\timeallowed{<n> hours}|
\end{desc}
Specifies the time allowed (required).

\begin{desc}
|\copyrightyear{...}|
\end{desc}
Sets the date for copyright, used in the footer on the front page (optional, default is same as |\examyear|).


\begin{desc}
|\suppno{...}| %can be omitted for "DRAFT"
\end{desc}
Sets the SUPP number for |specimen| and |secondspecimen| options, mainly used by DPU/LTS (optional, default is blank).

\begin{desc}
|\versionno{...}| %optional
\end{desc}
Sets the version number for |specimen| and |secondspecimen| options, mainly used by DPU/LTS (optional, default is blank).

\begin{desc}
|\faculty{...}| %optional
\end{desc}
Sets the name for the faculty (appears in |specimensolutions| mode only). The default is `Faculty of Science, Technology, Engineering and mathematics'.

\begin{desc}
|\optiontext{...}|
\end{desc}
Changes the text that appears at the top of multi-choice questions (optional, default is `Options:'). Does not need to be in the preamble, so you can change the text for options part-way through the document.

\begin{desc}
|\submitby[<time>]|
\end{desc}
With the |remote| option selected, this command adds `Submit by: 23:59 BST' to the front page for remote exams that have a fixed deadline. The time (default `23:59 BST') can be changed with the optional parameter |[<time>]|.

If |\submitby| is not used with the |remote| exam option, then the text `Submit by:' does not appear on the cover page.

\begin{desc}
|\examinstructions{...}|
\end{desc}
Command for the instructions/rubric on the front page of the exam (optional, but defaults to `No special instructions specified.')

\begin{desc}
|\oulogofilebase{...}|
\end{desc}
Overrides the internally-specified for the name of the OU logo, currently |OU_Master_Logo_Black_CMYK_29mm|. The filename should be specified \emph{without} extension (|.pdf| or |.eps|), as this will be added automatically depending on whether the source file is compiled using |latex| or |pdflatex|.

\LaTeX\ files that use \textsf{OU-SUPPS} class files do \emph{not} need the OU logo to compile: if the specified logo file is not present, a placeholder box will be inserted instead.

\begin{desc}
|\switchmarks|
\end{desc}
This command (which can be used anywhere, but best used in the preamble) defines the various commands for entering marks so that any comments appear to the left of the mark. This applies only to marks for solutions.

\begin{desc}
|\setlength\toppadding{<x>}|
\end{desc}
Adjusts the padding at the top of the title page to |<x>|. Default is |0.5cm|, and this should only be changed if you know what you're doing.

\begin{desc}
|\metadataset{key=value}|  
\end{desc}
As an alternative to specifying the above commands individually, they can 
all  be configured using a |key=value| approach in the |\metadataset|
command; for example:
\begin{verbatim}
\metadataset{
            module code=MST125,
            session=D,
            module title=Title of Module,
            specimen solutions title=specimen solution title,
            exam code=MST1241706F1PV1,
            exam time=10am--2pm,
            exam day=Wed,
            exam month=Oct,
            exam year=2017,
            time allowed=3.5 hours,
            copyright year=2017,
            supp no=3,
            version no=2.12,
            faculty=STEM,
            multiple choice option text=choices,
            instructions= your instructions here,
            top padding=0.5cm,
            switch marks=true,
            }
\end{verbatim}

\subsection{Creating questions}\label{subsec-ouexam-questions}
The internal counter used for generating questions is |question|. 

\subsubsection{Question syntax}

\begin{desc}
|\question[<description>]|
\end{desc}
Creates a question. The parameter |<description>| is optional, and can be used to provide additional information about the question in its header line. 


\subsubsection{Subquestions}
To create subquestions, use the standard \LaTeX\ |enumerate| environment.

\begin{verbatim}
\begin{enumerate}
\item ...
\item ...
...
\end{enumerate}
\end{verbatim}

These environments can be nested to create subsubquestions, etc. The default numbering style is |(a),(b),...| for subquestions, and |(i),(ii),...| for subsubquestions.

For inline subquestions, use the starred version of the |enumerate| environment:

\begin{verbatim}
\begin{enumerate*}
\item ...
\item ...
...
\end{enumerate*}
\end{verbatim}

Numbering style for |enumerate*| is |(i),(ii),...| at all levels. This can be adjusted using |enumitem| (see below).

The class file |ouexam.cls| loads the |enumitem| package, which provides a number of features, two of which we list here.

\begin{itemize}
\item Changing the numbering: Start the environment using, e.g.\ |\begin{enumerate}[A.]|, to modify the numbering system to |A.,B.,...|.
\item Resuming numbering after a break: use |\begin{enumerate}[resume]| to continue counting from the previous time an enumerate environment at this level was called.
\end{itemize} 

For fuller details of the possibilities with |enumitem|, see the documentation on its CTAN entry.

\subsubsection{Marks}
Marks can be placed anywhere in the document (including inside displayed equations). You may need to  compile your |tex| file twice in order for the marks to be correctly aligned.

\begin{desc}
|\mk{<n>}|
\end{desc}
Places |<n>| in square brackets in the right hand margin on the line. 

%\begin{desc}
%|\marks{<n>}|
%\end{desc}
%A synonym for |\mk|, preserved as part of legacy support from the earliest versions of |ouexam.cls|. Because this synonym currently redefines a \TeX\ primitive, this command has been deprecated and will be removed in a future release.


\subsubsection{Multiple choice} 

For exams that have multiple choice questions, the following commands are available. The syntax is the same as for |ouab.cls| and |ouicma.cls|.

The text appearing at the top of each list of options can be changed using the |\optiontext{<title>}| command. This command can be used in the premable, or at any point in the document.

\begin{desc}
|\begin{options}|\\
|   \item ...|\\
|   \item ...|\\
|\end{options}|
\end{desc}
Creates a list of options, with the text of each |\item| starting on a new line. Options are labelled |A.,B.,C.,...|.

\begin{desc}
|\begin{inlineoptions}[<line spacing>]{<columns>}|\\
|   \item ...|\\
|   \item ...|\\
|\end{inlineoptions}|
\end{desc}
Creates a list of options, displayed in |<columns>| number of columns, equally spaced. Each successive |\item| is placed sequentially from left to right, then starting a new line as necessary. Options are labelled |A.,B.,C.,...|.

The optional parameter |<line spacing>| can be used to increase the spacing between each line. However, note that this also affect spacing within options, which can have undesired effect if your options include, e.g., a |matrix| environment.

\begin{desc}
|\noitem|
\end{desc}
This command can be used within  |inlineoptions| to leave a `blank' in the list of options. This is particularly useful on the final line if you have fewer |\item|s left than the specified number of |<columns>|.

\subsubsection{Pagination}
As well as the usual commands such as |\pagebreak|, it is possible to specify different page breaks depending on whether |showsolutions| is enabled or not.
\begin{desc}
|\questionbreak|
\end{desc}
Inserts a |\pagebreak| command when the |showsolutions| option is not specified.

\begin{desc}
|\solutionbreak|
\end{desc}
Inserts a |\pagebreak| command when the |showsolutions| option is specified.



%
%
%
%
%
%
%
\subsection{Creating solutions to live exams}\label{subsec-ouexam-solutions}

For creating solutions to real exams (as opposed to specimen solutions, whose presentation is different and should be handled as in Subsection~\ref{subsec-specs}), the |solution| environment is provided as a wrapper, so that both the exam and its solutions can (in theory) be generated from the same single tex file (by specifying |showsolutions| or not). 

\begin{desc}
|\begin{solution}|\\
|...|\\
|\end{solution}|
\end{desc}

Enter the contents of solutions inside the |solution| environment. This is simply a wrapper environment, and can be used within an |enumerate| environment (i.e.\ solutions per subquestion/subsubquestion), and/or you can use |enumerate| environments inside the solution environment. 

The text inside the |solution| environment is \emph{only} displayed when one of the |showsolutions| or the |specimensolutions| options is specified in the preamble. 

When displayed, the solutions can be formatted in one of two ways:
\begin{description}
\item[{|[specimensolutions]| or |[specimen,showsolutions]|:}] The text is displayed without further formatting.
\item[{|[showsolutions]|:}] The text of the solutions is set to |\small|, and placed on a beige background with a thick black line on the left, to indicate the scope of the solution.
\end{description}

\emph{Note:} The showing/hiding solutions features of |ouexam| are designed for use by authors when drafting exams, to help you check answers tally up to the corresponding questions. When creating the final version for handover, you will probably want to make two copies of your working file, one to create the exam (with solutions removed), the other to create the solutions (possibly with the questions removed, though this is option except for specimen solutions).

\subsubsection{Customising the \texttt{solution} environment appearance}

The |solution| environment is defined by an environment called |solutionbox|, which is created using the |mdframed| package. It is specified as follows.

\begin{desc}
|\newmdenv[linewidth=3pt,|\\
|      topline=false,|\\
|      bottomline=false,|\\
|      rightline=false,|\\
|      innerrightmargin=5.5cm,|\\
|      innerleftmargin=10pt,|\\
|      linecolor=black,|\\
|      backgroundcolor=yellow!10,|\\
|      frametitle=Solution]{solutionbox}|
\end{desc}

You can replace this using |\renewmdenv[...]{solutionbox}|. See the |mdframed| package documentation for details.

\subsubsection{Specifying marks within the \texttt{solution} environment}

\begin{desc}
|\mk[<description>]{<n>}[<voffset>]|\\
|\mk*[<description>]{<n>}[<voffset>]|
\end{desc}
This command can be used to specify marks, as per the format for creating questions. Within the |solution| environment in |[showsolutions]| mode, the numbers are displayed in the right-hand margin in text size |\small|, and without square brackets. Additionally, the optional |<description>| parameter allows users to enter text in the margin, to the right of the |<n>|. 

If the |\switchmark| command is issued (see Subsubsection~\ref{ouexam-preamble}) then the mark |<n>| is placed to the \emph{right} of any |<description>|.

The optional final parameter |[<voffset>]| allows you to move the entire margin note up or down the page. |<voffset>| should be a measure (so needs units, such as |pt|, |cm|, |em| etc). This parameter can be useful when you have multiple margin notes that would otherwise overlap with one another. For example: |\mk[Long discussion]{2}[24pt]|.

The starred variant |\mk*| performs the same function, but does not add the value of |<n>| to the |total| and |subtotal| counters, so can be used, e.g., if several solutions are possible with separate mark schemes.

\emph{Note:} |<n>| can be non-numeric, but if anything other than an integer is entered, then the |\subtotal*| and |\total*| commands will return the wrong sum.

\begin{desc}
|\solnmarksplus{<n>}{<description>}|\\
|\mkplus{<n>}{<description>}|
\end{desc}
Some deprecated equivalent commands that produce the same effect as |\mk[<description>]{<n>}|.


\begin{desc}
|\subtotal[<description>]{<n>}[<voffset>]|\\
|\total[<description>]{<n>}[<voffset>]|
\end{desc}

Specifies that the subtotal or total for a part-question or question is |<n>|, placing |<n>| in the margin, and the word `Subtotal' or `Total' in large, bold to its right. The optional argument |<description>| can be used to append wording to the word `Total'. Typical usages of the |<description>| parameter are:\\ 
|\subtotal[for part \theenumi]{<n>]}|\\
|\total[for Question \thequestion]{<n>]}|.

See under the description of |\mk| above for information on usage of the optional parameter |[<voffset>]|.

\begin{desc}
|\subtotal*[<description>]|\\
|\total*[<description>]|
\end{desc}

Calculates the subtotal or total for a part-question or question, placing 
the calculated value in the margin, and the word `Subtotal' or `Total' in large, 
bold to its right; the calculated value accounts for all marks given in 
any of the following commands, but only \emph{within} a |solution| environment: |bracketedmarks|, |solnmarks|, |solnmarksplus|, 
|marks|, |mk|, and |mkplus|. The optional argument |<description>| is the same 
as with the |\subtotal| and |\total| commands. 

\emph{Note:} Marks entered into the |\mk*| variant will not be added to the |subtotal| and |total| counters.

\subsubsection{Rules}

Primarily aimed at the creation of exam solutions (though they will work in any file using |ouexam.cls|), the available commands for rules are the same as for |outn|.

\begin{desc}
|\setSubtotalHline[<options>]|
\end{desc}

Sets options (including turning off) for horizontal lines after |\subtotal| and
|\subtotal*| command. Supported options, in any order, are:
\begin{itemize}
  \item |moveleft=<length>|, default is |.1\textwidth|: specifies the horizontal offset of the line;
  \item |width=<length>|, default is |1.5\textwidth|: specifies the horizontal width of the line;
  \item |height=<length>|, default is |2pt|: specifies the height of the line;
  \item |color=<color>|, default is |black|: specifies the colour of the line;
  \item |draw line=<true/false>|, default is |true|: specifies if the line is to be drawn or not.
\end{itemize}

Simply calling |\setSubtotalHline| without options, resets all of the options
to their default values.

Sample uses include, for example:

|\setSubtotalHline[moveleft=0pt]|

|\setSubtotalHline[moveleft=0pt,height=5pt,color=orange]|

This command is just a short cut to the |\pgfkeys| command, and 
users familiar with the syntax of |\pgfkeys| might prefer to use, 
for example:

|\pgfkeys{/subtotalhline,default,moveleft=-3cm,color=red!40!white}|

\begin{desc}
|\setTotalHline[<options>]|
\end{desc}
This is analogous to the |\setSubtotalHline| command, and customises the lines
drawn (if any) after the |\total| and |\total*| commands. It takes exactly 
the same options as |\setSubtotalHline|, and each option performs the analogous
task; the default |height| for the |subtotal| horizontal lines is |1pt|, 
but all other defaults are the same as those for the  |total| horizontal lines.

Users who prefer to use |\pgfkeys| directly may use, for example,

|\pgfkeys{/totalhline,default,moveleft=-3cm,color=red!40!white}|

\begin{desc}
|\ourule[<options>]|
\end{desc}
This command enables users to draw a horizontal rule manually at some point in their tutor notes, 
not using any of the |\subtotal| and friends commands. It takes exactly the 
same options as |\setSubtotalHline|, and each option performs the analogous
task. The default 
values are copied from the default values of the |\setTotalHline|.

\begin{desc}
|\setOUrule[<options>]|
\end{desc}
Users may specify global options for their |\ourule| command in exactly the same 
way as in |\setSubtotalHline| and |\setTotalHline|.

Users who prefer to use |\pgfkeys| directly may use, for example,

|\pgfkeys{/ourule,default,moveleft=-3cm,color=red!40!white}|


\subsubsection{Pagination}
As well as the usual commands such as |\pagebreak|, it is possible to specify different page breaks depending on whether |showsolutions| is enabled or not.
\begin{desc}
|\questionbreak|
\end{desc}
Inserts a |\pagebreak| command when the |showsolutions| option is not specified.

\begin{desc}
|\solutionbreak|
\end{desc}
Inserts a |\pagebreak| command when the |showsolutions| option is specified.

%
%
%
%
%
%
\subsection{Alternative method to create solutions}
If you prefer not to have solutions appearing in-line with the questions, an alternative method is to place all solutions at the end. You should not use this method for creating specimen solutions.


\begin{desc}
|\solutions|
\end{desc}

This flag behaves similarly to the |\appendix| flag in standard \LaTeX\ files: here, |\solutions| marks the end of the exam paper, resets the |question| counter, and redefines the text in the |\question| command to `Solution to Question~|\thequestion|'. 

Solutions can then be created using the |\question| command to create questions, and all other commands are available.


\emph{Important note:} Contents after the |\solutions| flag will be displayed irrespective of whether the |showsolutions| option is specified in the preamble. However, you may want to specify |showsolutions| in order to adjust the formatting of the cover page.


%
%
%
%
%
%
\subsection{Creating specimens and specimen solutions}\label{subsec-specs}

The process of creating specimen exams is broadly similar to that of creating exams, with some specific requirements in the preamble. On the other hand, creating solutions to specimen exams is different from the processes used for creating solutions to live exams (shown above), since the resulting formatting must be of suitable quality for student use.

\subsubsection{Setting up the preamble for specimen exams}

Since specimen papers and their solutions do not have dates and times associated with them, the preamble for these documents is different. Here is a typical (minimal) example for a specimen exam.

\begin{desc}
|\documentclass[specimen]{ouexam}|\\
|\modulecode{Mxyz}|\\
|\moduletitle{Title of Module}|\\
|\timeallowed{3 hours}|\\
|\copyrightyear{2016}|\\
|\examinstructions{%|\\
|\textbf{Instructions}|\\
| |\\
|Insert module-specific examination instructions here|\\
|}|\\
|\begin{document}|
\end{desc}

For the second specimen exam, one can use the |secondspecimen| option.
\begin{desc}
|\documentclass[secondspecimen]{ouexam}|	
\end{desc}
The result of this command is to insert the text `Second specimen' at the top of the cover page, and in the footer of all internal pages. This can also be achieved using the following.
\begin{desc}
|\documentclass[specimen]{ouexam}|\\
|\session{Second specimen}|
\end{desc}

This method can also be used to create, e.g., a `Third specimen' by making the obvious changes.

\subsubsection{Setting up the preamble for specimen solutions}

The following illustrates a typical preamble for specimen solutions documents.

\begin{desc}
|\documentclass[specimensolutions]{ouexam}|\\
|\modulecode{Mxyz}|\\
|\moduletitle{Title of Module}|\\
|\copyrightyear{2016}|\\
|\begin{document}|
\end{desc}

For solutions to the second specimen exam, one can use the options |secondspecimen| and |showsolutions|.
\begin{desc}
|\documentclass[secondspecimen,showsolutions]{ouexam}|
\end{desc}
The result of this command is to change the title to `Mxyz Solutions to the Second specimen Examination Paper' at the top of the first page. This can also be achieved using the following.
\begin{desc}
|\documentclass[specimensolutions]{ouexam}|\\
|\specimensolutionstitle{Solutions to the Second specimen Examination Paper}|
\end{desc}

This method can also be used to create, e.g., solutions to the `Third specimen' by making the obvious changes.

\subsubsection{Formatting the internal text of specimens and solutions}

The process for formatting the questions of a Specimen examination paper are identical to those described in Subsection~\ref{subsec-ouexam-questions}.

The process for formatting the solutions in a |specimensolutions| document do not need to follow the guidelines laid out in Subsection~\ref{subsec-ouexam-solutions}. In particular, it is not necessary to use the |solution| environment (although if you use this, it will cause no harm to your document). All that is required is the |\question| command, and then you start typing:
\begin{desc}
|\question|\\
|Write your solution to the question here|	
\end{desc}

Generally speaking, one does not include marks or part marks in specimen solutions, but if you need to do this, then you can use the |\mk| command as specified in previous sections.


%
%
%
%
%
\subsection{Technical info}
This section can be omitted unless you need/want to know a bit more about the class file.

\subsubsection{Packages loaded}
|ouexam.cls| loads the following packages automatically, so you do not need to call |\usepackage{...}| to use the features provided by these.

\begin{itemize}
\item |geometry| to set page margins, sizes, etc
\item |fancyhdr| for formatting headings
\item |graphicx| for handling images, etc
\item |changepage| to adjust page widths automatically
\item |array| extends the |array| and |tabular| environments.
\item |amsmath| loaded with the |fleqn| option to left-align displayed mathematics.
\item |amssymb| extra mathematical symbols
\item |zref-user|, |zref-lastpage| for knowing how many pages the document contains
\item |ifthen| for internal latex coding
\item |enumitem|. This is a powerful tool that will help preparing subquestions.
\item |marginnote| for handling marks, etc in the margin.
\item |mdframed| with option |xcolor| to provide formatting for coloured boxes to display solutions. This is only loaded if |showsolutions| is specified, otherwise |xcolor| is loaded on its own.
\item |verbatim| to ensure the contents of the |solution| environment is hidden unless |showsolutions| is specified.
\item |makebarcode| for creating the barcode on the front page. Not loaded if |nobarcode| option is specified.
\item |extsizes| when options |14pt|, |17pt| or |20pt| are used, to handle larger font sizes. 
\item |pgfkeys| for setting flexible options in commands.
\end{itemize}

%
%
%
%
%
%
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Using \texttt{ouicma.cls}}

\subsection{Preamble}
\subsubsection{Commands to be used in the preamble}
\begin{desc}
|\faculty{...}|
\end{desc}
The name of the faculty (optional, default is `Faculty of Science, Technology, Engineering and Mathematics')
\begin{desc}
|\modulecode{...}|
\end{desc}
Sets the code of the module (required).
\begin{desc}
|\moduletitle{...}|
\end{desc}
Sets the title (i.e./ name) of the module (required).

\begin{desc}
|\icmatitle{...}|
\end{desc}
Sets the title for the iCMA (required).

\begin{desc}
|\icmasubtitle{...}|
\end{desc}
Sets the subtitle for the iCMA (optional).

\begin{desc}
|\icmayear{...}|
\end{desc}
Sets the year/presentation for this iCMA (required).

\begin{desc}
|\copyrightyear{...}|
\end{desc}
Sets the date for copyright, used in the footer on the front page (optional, default is same as |\icmayear|).


\begin{desc}
|\suppno{...}| %can be omitted for "DRAFT"
\end{desc}
Sets the SUPP number, mainly used by DPU/LTS (optional, default is `DRAFT').

\begin{desc}
|\versionno{...}| %optional
\end{desc}
Sets the version number, mainly used by DPU/LTS (optional, default is blank).

\begin{desc}
|\optiontext{...}|
\end{desc}
Changes the text that appears at the top of multi-choice questions (optional, default is `Options:'). Does not need to be in the preamble, so you can change the text for options part-way through the document.

\begin{desc}
|\cutoffdate{...}|
\end{desc}
Specifies the cut-off date for the iCMA.

\begin{desc}
|\coversmaterialin{...}|
\end{desc}
Specifies the material covered by the iCMA.

\begin{desc}
|\instructions{...}|
\end{desc}
Command for the instructions/rubric on the front page of the booklet (optional, but defaults to `No special instructions specified.')

\begin{desc}
|\declaration{...}|
\end{desc}
Allows you to change the declaration on page 3 of the iCMA. This is optional, and the default is as follows.

\begin{verbatim}
\textbf{Read and complete the following --- otherwise your work will 
not be marked}\\\bigskip
The University has to ensure as far as possible that the work submitted by 
students is their own and that credit is not given for unreferenced material 
from other sources. The University statement `What constitutes 
plagiarism or cheating' appears in the Plagiarism Policy Document and in 
your Assessment Handbook and you are expected to have familiarised 
yourself with it. Please be aware that the University may subject your 
work to checks (including computerised checks) for plagiarism and in some 
instances may need to seek further information from you. Any cases where 
a basis for concern about the originality of the work is identified will be 
considered under the University's policy on academic conduct. 

I confirm that I have read the statement `What constitutes plagiarism or 
cheating' and that my answers will be my own work. \bigskip

Signature:\\[20pt]

\rule{\textwidth}{2pt}\\[20pt]

Name (in block capitals):\\[20pt]

\rule{\textwidth}{2pt}\\[20pt]

Personal identifier (PI): \\[20pt]

\rule{\textwidth}{2pt}\\[20pt]
\end{verbatim}




\begin{desc}
|\oulogofilebase{...}|
\end{desc}
Overrides the internally-specified for the name of the OU logo, currently |OU_Master_Logo_Black_CMYK_29mm|. The filename should be specified \emph{without} extension (|.pdf| or |.eps|), as this will be added automatically depending on whether the source file is compiled using |latex| or |pdflatex|.

\LaTeX\ files that use \textsf{OU-SUPPS} class files do \emph{not} need the OU logo to compile: if the specified logo file is not present, a placeholder box will be inserted instead.


\begin{desc}
|\metadataset{key=value}|  
\end{desc}
As an alternative to specifying the above commands individually, they can 
all be configured using a |key=value| approach in the |\metadataset|
command; for example:
\begin{verbatim}
\metadataset{faculty=STEM, 
            module code=MST140,
            module title=Title of Module,
            presentation=2017B,
            document title=iCMA title,
            supp no=3.14159,
            cut off date=27th Oct,
            covers material in={Units 1, 2 and 3},
            multiple choice option text=choices,
            %instructions=some specific instructions,
            %declaration=your own declaration here,
            }
\end{verbatim}
\subsection{Creating questions}

\subsubsection{Question syntax}

\begin{desc}
|\question|
\end{desc}
Creates a new question. Unlike other class files in \textsf{OU-SUPPS}, this takes no parameters.

\subsubsection{Subquestions}
To create subquestions, use the standard \LaTeX\ |enumerate| environment.

\begin{verbatim}
\begin{enumerate}
\item ...
\item ...
...
\end{enumerate}
\end{verbatim}

These environments can be nested to create subsubquestions, etc. The default numbering style is |(a),(b),...| for subquestions, and |(i),(ii),...| for subsubquestions.

The class file |ouab.cls| loads the |enumitem| package, which provides a number of features, two of which we list here.

\begin{itemize}
\item Changing the numbering: Start the environment using, e.g.\ |\begin{enumerate}[A.]|, to modify the numbering system to |A.,B.,...|.
\item Resuming numbering after a break: use |\begin{enumerate}[resume]| to continue counting from the previous time an enumerate environment at this level was called.
\end{itemize} 

For fuller details of the possibilities with |enumitem|, see the documentation on its CTAN entry.

\subsubsection{Marks}
Marks can be placed anywhere in the document (including inside displayed equations). You may need to  compile your |tex| file twice in order for the marks to be correctly aligned.

\begin{desc}
|\mk{<n>}|
\end{desc}
Places |<n>| in square brackets in the right hand margin on the line. 

%\begin{desc}
%|\marks{<n>}|
%\end{desc}
%A synonym for |\mk|. This command has been deprecated and will be removed in a later release.


\subsubsection{Multiple choice} 

Multiple choice options can be produced using the following commands.

The text appearing at the top of each list of options can be changed using the |\optiontext{<title>}| command. This command can be used in the premable, or at any point in the document.

\begin{desc}
|\begin{options}|\\
|   \item ...|\\
|   \item ...|\\
|\end{options}|
\end{desc}
Creates a list of options, with the text of each |\item| starting on a new line. Options are labelled |A.,B.,C.,...|.

\begin{desc}
|\begin{inlineoptions}[<line spacing>]{<columns>}|\\
|   \item ...|\\
|   \item ...|\\
|\end{inlineoptions}|
\end{desc}
Creates a list of options, displayed in |<columns>| number of columns, equally spaced. Each successive |\item| is placed sequentially from left to right, then starting a new line as necessary. Options are labelled |A.,B.,C.,...|.

The optional parameter |<line spacing>| can be used to increase the spacing between each line. However, note that this also affect spacing within options, which can have undesired effect if your options include, e.g., a |matrix| environment.

\begin{desc}
|\noitem|
\end{desc}
This command can be used within  |inlineoptions| to leave a `blank' in the list of options. This is particularly useful on the final line if you have fewer |\item|s left than the specified number of |<columns>|.


\subsubsection{Answer boxes}

\begin{desc}
|\answerbox[<n>]|
\end{desc}

Places a 1.2cm $\times$ 1.2cm answer box in the right-hand margin. The optional parameter |<n>| allows you to place |<n>| answer boxes side-by side. If omitted, |<n>| is taken to be 1. Numbers greater than 4 are unlikely to look good.

\begin{desc}
|\wideanswerbox[<n>]|
\end{desc}

Places a 2.4cm $\times$ 1.2cm wide answer box in the right-hand margin. The optional parameter |<n>| allows you to place |<n>| answer boxes side-by side. If omitted, |<n>| is taken to be 1. Numbers greater than 2 are unlikely to look good.


\subsection{Technical info}

|ouab.cls| loads the following packages automatically, so you do not need to call |\usepackage{...}| to use the features provided by these.

\begin{itemize}
\item |geometry| to set page margins, sizes, etc
\item |fancyhdr| for formatting headings
\item |graphicx| for handling images, etc
\item |changepage| to adjust page widths automatically
\item |array| extends the |array| and |tabular| environments.
\item |amsmath| loaded with the |fleqn| option to left-align displayed mathematics.
\item |amssymb| extra mathematical symbols
\item |zref-user|, |zref-lastpage| for knowing how many pages the document contains
\item |ifthen| for internal latex coding
\item |enumitem| with options |inline| and |shortlabels|. This is a powerful tool that will help preparing subquestions (see later).
\item |marginnote| for handling marks, etc in the margin.
\item |tikz| to draw boxes in the margin.
\item |mdframed| to format the question headers.
\end{itemize}




%
%
%
%
%
%
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Summary of keys available for \texttt{metadataset}}
Table~\ref{tab:metadataset} provides a summary of the available keys
for the |metadataset| command in each of the |OU|-based class files.

\begin{longtable}{lcccc}
	\caption{Keys available to \texttt{metadataset} in each OU class file.}\label{tab:metadataset}\\
	\toprule
	                              & |ouab.cls|        & |ouexam.cls|      & |ouicma.cls|      & |outn.cls|        \\
	\midrule
	|faculty|                     & \metakeyavailable & \metakeyavailable & \metakeyavailable & \metakeyavailable \\
	|module code|                 & \metakeyavailable & \metakeyavailable & \metakeyavailable & \metakeyavailable \\
	|module title|                & \metakeyavailable & \metakeyavailable & \metakeyavailable & \metakeyavailable \\
	|multiple choice option text| & \metakeyavailable & \metakeyavailable & \metakeyavailable & \metakeyavailable \\
	|ou logo file base| & \metakeyavailable & \metakeyavailable & \metakeyavailable & \metakeyavailable \\
	|copyright year|             & \metakeyavailable & \metakeyavailable & \metakeyavailable  & \metakeyavailable \\
	\cmidrule{2-5}
	|document title|              & \metakeyavailable &                   & \metakeyavailable & \metakeyavailable \\
	|presentation|                & \metakeyavailable &                   & \metakeyavailable & \metakeyavailable \\
	|supp no|                     & \metakeyavailable & \metakeyavailable & \metakeyavailable &                   \\
	|instructions|                & \metakeyavailable & \metakeyavailable & \metakeyavailable &                   \\
	|version no|                  & \metakeyavailable & \metakeyavailable & \metakeyavailable &                   \\
	\cmidrule{2-5}
	|document subtitle|           & \metakeyavailable &                   & \metakeyavailable &                   \\
	|no cut off date|             & \metakeyavailable &                   &                   &                   \\
	%\cmidrule{2-5}
	|session|                     &                   & \metakeyavailable &                   &                   \\
	|specimen solutions title|    &                   & \metakeyavailable &                   &                   \\
	|exam code|                   &                   & \metakeyavailable &                   &                   \\
	|exam time|                   &                   & \metakeyavailable &                   &                   \\
	|exam day|                    &                   & \metakeyavailable &                   &                   \\
	|exam month|                  &                   & \metakeyavailable &                   &                   \\
	|exam year|                   &                   & \metakeyavailable &                   &                   \\
	|time allowed|                &                   & \metakeyavailable &                   &                   \\
	%\cmidrule{2-5}
	|cut off date|                &                   &                   & \metakeyavailable &                   \\
	|covers material in|          &                   &                   & \metakeyavailable &                   \\
	|declaration|                 &                   &                   & \metakeyavailable &                   \\
	%\cmidrule{2-5}
	|specimen solutions color|    &                   &                   &                   & \metakeyavailable \\
	|tutor only title|            &                   &                   &                   & \metakeyavailable \\
	|student only title|          &                   &                   &                   & \metakeyavailable \\
	\bottomrule
\end{longtable}
\pagebreak
\section{Moving from OUTeX}

Some features in OUTeX have not been carried over. Here is some help to help you adjust to standard \LaTeX.

\begin{tabular}{@{}p{0.3\textwidth}@{\hspace{0.05\textwidth}}p{0.65\textwidth}@{}}
OUTeX& \LaTeX\\\hline
Figures & Use the standard LaTeX figure environment. e.g.\newline
|\begin{figure}\label{<label>}|\newline
|\centering|\newline
|\includegraphics{<image>}|\newline
|\caption{<caption>}|\newline
|\end{figure}|\newline
See sources online for options to float figures, etc.
\\\hline
Compiling: |latex|, |dvips| + |ps2pdf| with |eps| files & You can use |pdflatex| with |eps| files, but to do so you need to add this to the preamble:\newline
|\usepackage{epstopdf}|\newline
The alternative is to use the old route |latex|, |dvips| + |ps2pdf|.
\\\hline
|\intertext|&|\end{enumerate}...\begin{enumerate}[resume]|\\\hline
|\|\texttt{\textless ...\&...}|\|\texttt{\textgreater}&|\begin{align*}...&...\end{align*}|\newline
You can recover the OUTeX command by inserting the following into your preamble:\newline
|\def\|\texttt{\textless}|#1\|\texttt{\textgreater}|{\begin{align*}#1\end{align*}}|\newline
However, we do not recommend you use this, as it will not be understood by anyone not previously familiar with OUTeX (e.g. ALs), and will mean snippets of your code won't work out of the context of the file it's in.
\\\hline
|\[ ... \\ ... \]|&
|\begin{gather*}...\\...\end{gather*}|
\\\hline
Matrix alignment & Load the |mathtools| package, so you can write e.g.\newline |\begin{pmatrix}[l]|\newline |<matrix>|\newline |\end{pmatrix}|\newline to left-align all columns. Alternatively (and to specify different column alignments) use the |array| environment instead, e.g.:\newline |\left(\begin{array}{lrcl}|\newline |<matrix>|\newline|\end{array}\right)|.
\\\hline
Binomials (column vector)& |\binom{n}{k}|\\\hline
|\setright{\text{<text>}}|&|\tag{<text>}|\\\hline
|\solnmarksplus{<a>}{<b>}|&|\mk[<b>]{<a>}|\\\hline
\end{tabular}

\end{document}
